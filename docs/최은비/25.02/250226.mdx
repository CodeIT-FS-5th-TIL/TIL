## prisma migrateì‹œ enum íƒ€ì…ì„¤ì •ìœ¼ë¡œ ì¸í•œ ì˜¤ë¥˜

### ì—ëŸ¬ ë©”ì‹œì§€

"Invalid value for argument `resourceType`. Expected ResourceType."

### ë¬¸ì œ ì›ì¸

ëŒ“ê¸€(comment) ìŠ¤í‚¤ë§ˆì— resourceType í•„ë“œë¥¼ ë§Œë“¤ì–´ì„œ íƒ€ì…ì„ ResourceType(enum) ìœ¼ë¡œ ì£¼ê³  ê²Œì‹œê¸€(Article), ìƒí’ˆ(Product)ë‘˜ ì¤‘ì— í•˜ë‚˜ì¸ enum íƒ€ì…ìœ¼ë¡œ ì§€ì •í•´ì£¼ì—ˆëŠ”ë°,
eunm íƒ€ì…ì„ ëŒ€ë¬¸ìë¡œ ì§€ì •í•´ì£¼ì§€ì•Šì•„ì„œ ë°œìƒí•œ ì—ëŸ¬ì˜€ë‹¤.

- ì²˜ìŒì— ì‘ì„±í–ˆë˜ ìŠ¤í‚¤ë§ˆ

```
model Comment {
  id           String        @id @default(uuid())
  resourceType ResourceType?
  resourceId   String
  content      String
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

enum ResourceType {
  Product
  Article
}
```

- ìˆ˜ì • í›„

```
model Comment {
  id           String        @id @default(uuid())
  resourceType ResourceType?
  resourceId   String
  content      String
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

enum ResourceType {
  PRODUCT
  ARTICLE
}
```

## ê·¸ëŸ°ë°, ìˆ˜ì • í›„ì—ë„ ì½˜ì†”ì„ ì°ì–´ë³´ë‹ˆ ì—¬ì „íˆ ì†Œë¬¸ì..!

'resourceType: product' ë¡œ ì°íˆëŠ” ê²ƒì´ì—ˆë‹¤. ì‹¬ì§€ì–´ ì œì¼ ì²«ê¸€ìë„ ì†Œë¬¸ìë¡œ ë°”ë€œ.

ë²”ì¸ì€ ë°”ë¡œ

## ğŸ•µğŸ»â€â™‚ï¸ url ê²½ë¡œì—ì„œ resourceType ê°’ì„ ì¶”ì¶œí•˜ëŠ” extractResource(req) í•¨ìˆ˜

```js
const extractResource = (req) => {
  const path = req.baseUrl; // ì˜ˆ: "/api/products" ë˜ëŠ” "/api/articles"
  let resourceType;
  let resourceId;

  if (path.includes("/products")) {
    resourceType = "product";
    resourceId = req.params.id;
  } else if (path.includes("/articles")) {
    resourceType = "article";
    resourceId = req.params.id;
  } else {
    throw new Error("Invalid resource type");
  }

  return { resourceType, resourceId };
};
```

- req(ìš”ì²­ ê°ì²´)ë¥¼ ë°›ì•„ì„œ resourceType(ë¦¬ì†ŒìŠ¤ ì¢…ë¥˜)ê³¼ resourceId(ë¦¬ì†ŒìŠ¤ ID)ë¥¼ ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.
  ex) URL ê²½ë¡œ (path)ì— "/products"ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´: resourceTypeì„ "product"ë¡œ ì„¤ì •
  ë°”ë¡œ ì—¬ê¸°ì— resourceTypeì„ ë”± ì†Œë¬¸ìë¡œ ì„¤ì •í•˜ë¼ê³  ì§€ì •í•´ë†“ì•˜ë˜ ê²ƒì´ ë¬¸ì œê°€ ëœê²ƒì´ë‹¤.

ì´ í•¨ìˆ˜ì—ì„œë„ productì™€ articleì„ ëª¨ë‘ ëŒ€ë¬¸ìë¡œ ë³€ê²½í•´ì£¼ì—ˆë‹¤.
ì´í›„ ëŒ“ê¸€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ëŠ” ì„œë¹„ìŠ¤ í•¨ìˆ˜ì— ì½˜ì†” ì°ì–´ë³´ë‹ˆ ì˜ ë³€ê²½ë˜ì–´ ì—ëŸ¬ í•´ê²°ëœ ê²ƒ í™•ì¸ ~!

### fetchCommentList í•¨ìˆ˜ ì½˜ì†”ë¡œê·¸ í™•ì¸

```
const fetchCommentList = async (cursor, limit, resourceType, resourceId) => {
  console.log("ğŸ” resourceType :", resourceType); //resourceType í™•ì¸
  const prismaResourceType = resourceType;

  const take = parseInt(limit) || 10; // í•œ ë²ˆì— ê°€ì ¸ì˜¬ ë°ì´í„° ê°œìˆ˜
  const cursorOptions = cursor
    ? { skip: 1, cursor: { id: cursor } } // ì´ì „ ë°ì´í„°ë¥¼ ê±´ë„ˆëœë‹ˆë‹¤.
    : {};

  return await prisma.comment.findMany({
    ...cursorOptions,
    take,
    where: {
      resourceType: prismaResourceType,
      resourceId,
    },
    orderBy: { createdAt: "asc" },
  });
};
```

"ğŸ” resourceType : PRODUCT"
