# NEXT Hydration ë„ˆ ë­”ë°?

í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œì‹¤í–‰ ì‹œ Unhandled Runtime Error ë°œìƒ
Error: "Hydration failed because the server rendered HTML didn't match the client."
ì„œë²„ê°€ ë Œë”ë§í•œ HTMLì´ í´ë¼ì´ì–¸íŠ¸ì™€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ í•˜ì´ë“œë ˆì´ì…˜ì— ì‹¤íŒ¨.

- A server/client branch if (typeof window !== 'undefined').
- Variable input such as Date.now() or Math.random() which changes each time it's called.
- Date formatting in a user's locale which doesn't match the server.
- External changing data without sending a snapshot of it along with the HTML.
- Invalid HTML tag nesting.

It can also happen if the client has a browser extension installed which messes with the HTML before React loaded.
ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ë•Œë¬¸ì— ë°œìƒí•  ìˆ˜ë„ ìˆë‹¤ê³ í•œë‹¤.

## ë¬¸ì œ ì›ì¸

- useMemoì—ì„œ randomUsernamesë¡œ ëœë¤ ë‹‰ë„¤ì„ì„ í• ë‹¹í•˜ëŠ” ë¶€ë¶„ì—ì„œ
  randomUsernames[Math.floor(Math.random() * randomUsernames.length)]
  â†’ ì„œë²„ì—ì„œ ë Œë”ë§í•  ë•Œì™€ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë Œë”ë§í•  ë•Œ ë‹¤ë¥¸ ë‹‰ë„¤ì„ì´ í• ë‹¹ë  ê°€ëŠ¥ì„±ì´ ìˆìŒ
  â†’ Hydration ì˜¤ë¥˜ ë°œìƒ!

```js
const articlesWithUsername = useMemo(() => {
  return results.map((article) => ({
    ...article,
    username:
      article.username ||
      randomUsernames[Math.floor(Math.random() * randomUsernames.length)],
  }));
}, [results]);
```

## í•´ê²° ë°©ë²•

- í´ë¼ì´ì–¸íŠ¸ì—ì„œë§Œ ëœë¤ ë‹‰ë„¤ì„ì„ ë¶€ì—¬í•˜ë„ë¡ useEffectë¥¼ ì‚¬ìš©
- ì„œë²„ì—ì„œëŠ” í•­ìƒ ë™ì¼í•œ ê°’ì„ ìœ ì§€í•´ì•¼ í•¨
- useMemoê°€ ì•„ë‹ˆë¼ useEffectì—ì„œ setStateë¥¼ ì´ìš©í•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œë§Œ ì²˜ë¦¬

### ìˆ˜ì • ì „ ì½”ë“œ

```js
import { useMemo } from "react";

export default function ArticleList({ results = [] }) {
  const articlesWithUsername = useMemo(() => {
    return results.map((article) => ({
      ...article,
      username:
        article.username ||
        randomUsernames[Math.floor(Math.random() * randomUsernames.length)],
    }));
  }, [results]);
    . . .
```

### ìˆ˜ì • í›„ ì½”ë“œ

```js
import { useState, useEffect } from "react";

export default function ArticleList({ results = [] }) {
  const [articles, setArticles] = useState(results);

  useEffect(() => {
    const updatedArticles = results.map((article) => ({
      ...article,
      username:
        article.username ||
        randomUsernames[Math.floor(Math.random() * randomUsernames.length)],
    }));
    setArticles(updatedArticles);
  }, [results]);
  . . .
```

### ğŸ“

í•˜ì´ë“œë ˆì´ì…˜ ë¯¸ìŠ¤ë§¤ì¹˜ì— ëŒ€í•œ ë‚´ìš©: https://react.dev/link/hydration-mismatch

- ë¶ˆê°€í”¼í•˜ê²Œ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°„ì˜ ì†ì„±ì´ë‚˜ í…ìŠ¤íŠ¸ ë‚´ìš©ì´ ë‹¤ë¥¸ ê²½ìš°, suppressHydrationWarning={true}ë¥¼ ì¶”ê°€í•˜ì—¬ ê²½ê³ ë¥¼ ëŒ ìˆ˜ ìˆë‹¤ê³ í•œë‹¤.
  ê·¸ì¹˜ë§Œ ì„ì‹œë°©í¸ì„ìœ¼ë¡œ ì¶”ì²œí•˜ëŠ” ë°©ë²•ì€ ì•„ë‹ˆë¼ê³ ..
- ex)

```js
export default function App() {
  return (
    <h1 suppressHydrationWarning={true}>
      Current Date: {new Date().toLocaleDateString()}
    </h1>
  );
}
```
