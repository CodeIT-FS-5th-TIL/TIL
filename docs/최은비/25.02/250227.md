

ë‘˜ ë‹¤ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ë°ì´í„°ë¥¼ íŒ¨ì¹­í•˜ê³  ìºì‹±í•˜ëŠ” í›Œë¥­í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì§€ë§Œ, **ì‚¬ìš© ëª©ì ì— ë”°ë¼ ì„ íƒì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ**.




âœ… SWR vs React Query ë¹„êµ


|                         | **SWR**                 | **React Query**                               |
| ----------------------- | ----------------------- | --------------------------------------------- |
| **ê°œë°œì‚¬**                 | Vercel(Next.js ê°œë°œì‚¬)     | TanStack(ë…ë¦½ì  ì˜¤í”ˆì†ŒìŠ¤)                            |
| **ì´ˆê¸° ë¡œë”© ì†ë„**            | ë¹ ë¦„                      | ë¹ ë¦„                                            |
| **ìë™ ë°ì´í„° ê°±ì‹ **           | O (ìë™ìœ¼ë¡œ ìµœì‹  ë°ì´í„° íŒ¨ì¹­)      | O (ìë™ ë¦¬í˜ì¹˜ ê°€ëŠ¥)                                 |
| **ìºì‹± ë°©ì‹**               | ì „ì—­ì ìœ¼ë¡œ ê³µìœ  (ì „ì—­ SWR ìºì‹œ)    | ê°œë³„ì ìœ¼ë¡œ ê´€ë¦¬ (React Query ìºì‹œ)                     |
| **SSR ì¹œí™”ì„±**             | O (Next.jsì™€ ê¶í•© ì¢‹ìŒ)      | O (í•˜ì§€ë§Œ SWRë³´ë‹¤ëŠ” ì„¤ì •ì´ í•„ìš”í•¨)                        |
| **ë³µì¡í•œ ìƒíƒœ ê´€ë¦¬**           | X (ë‹¨ìˆœí•œ ë°ì´í„° íŒ¨ì¹­ì— ê°•ì )      | O (pagination, infinite scroll ë“± ìƒíƒœ ê´€ë¦¬ ê¸°ëŠ¥ í¬í•¨) |
| **Mutation(ë°ì´í„° ìˆ˜ì •/ì‚­ì œ)** | ì œí•œì  (useSWRMutation í•„ìš”) | ê°•ë ¥í•œ ì§€ì› (useMutation ì œê³µ)                       |


## **âœ… ì–¸ì œ SWRì„ ì„ íƒí•´ì•¼ í• ê¹Œ?**

- **Next.js í”„ë¡œì íŠ¸**ì—ì„œ **ê°„ë‹¨í•œ ë°ì´í„° íŒ¨ì¹­, ìë™ ê°±ì‹ , ìºì‹±**ì´ í•„ìš”í•œ ê²½ìš°
- í˜ì´ì§€ ê°„ **ì „ì—­ì ì¸ ìºì‹œ ê³µìœ ê°€ í•„ìš”í•œ ê²½ìš°**
- ì½”ë“œê°€ **ê°€ë³ê³  ê°„ê²°í•œ ê²Œ ì¤‘ìš”í•œ ê²½ìš°**
- **GraphQL, REST API ë“± ê°„ë‹¨í•œ ìš”ì²­ì„ ë¹ ë¥´ê²Œ ìºì‹±í•˜ê³  ì‹¶ì„ ë•Œ**

ğŸ”¹ **SWRì€ Next.jsì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì¶”ì²œí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¼ì„œ Next.js í”„ë¡œì íŠ¸ë¼ë©´ SWRì´ ë” ìì—°ìŠ¤ëŸ¬ìš¸ ìˆ˜ë„ ìˆìŒ!**


## **âœ… ì–¸ì œ React Queryë¥¼ ì„ íƒí•´ì•¼ í• ê¹Œ?**

- **ìƒíƒœ ê´€ë¦¬ + ë°ì´í„° íŒ¨ì¹­ì„ ë™ì‹œì— í•´ì•¼ í•˜ëŠ” ê²½ìš°**
- **Infinite Scroll, Pagination, Mutations (ë°ì´í„° ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ) ë“± ë³µì¡í•œ ë°ì´í„° ë¡œì§**ì´ í•„ìš”í•œ ê²½ìš°
- **SWRë³´ë‹¤ ë” ê°•ë ¥í•œ ìºì‹œ ì •ì±…ê³¼ ë¹„ë™ê¸° ìƒíƒœ ê´€ë¦¬ë¥¼ ì›í•  ë•Œ**
- ì—¬ëŸ¬ API ìš”ì²­ì„ ì¡°í•©í•´ì„œ **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ê´€ë¦¬í•´ì•¼ í•  ë•Œ**

## **<SWR ì‚¬ìš©ë²•>**


### **1ï¸âƒ£ ì„¤ì¹˜**


```shell
bash
ë³µì‚¬í¸ì§‘
npm install swr
# ë˜ëŠ”
yarn add swr
```


### **2ï¸âƒ£ ê¸°ë³¸ ì‚¬ìš©ë²•**


```javascript
jsx
ë³µì‚¬í¸ì§‘
import useSWR from "swr";

const fetcher = (url) => fetch(url).then((res) => res.json());

export default function Community() {
  const { data, error } = useSWR("https://sprint-mission08-be.onrender.com/articles", fetcher);

  if (error) return <div>âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ</div>;
  if (!data) return <div>â³ ë¡œë”© ì¤‘...</div>;

  return (
    <div>
      {data.list.map((article) => (
        <div key={article.id}>{article.title}</div>
      ))}
    </div>
  );
}
```


### **3ï¸âƒ£ ìƒì„¸ í˜ì´ì§€ì—ì„œ SWRë¡œ ë°ì´í„° íŒ¨ì¹­**


```javascript
jsx
ë³µì‚¬í¸ì§‘
import useSWR from "swr";
import { useRouter } from "next/router";

const fetcher = (url) => fetch(url).then((res) => res.json());

export default function ArticleDetail() {
  const router = useRouter();
  const { id } = router.query;
  const { data: article, error } = useSWR(id ? `/api/articles/${id}` : null, fetcher);

  if (error) return <div>âŒ ì˜¤ë¥˜ ë°œìƒ</div>;
  if (!article) return <div>â³ ë¡œë”© ì¤‘...</div>;

  return <div>{article.title}</div>;
}
```


### **4ï¸âƒ£ ë°ì´í„° ê°±ì‹  ë° ìºì‹± ìë™í™”**

- SWRì€ ê¸°ë³¸ì ìœ¼ë¡œ **ìë™ ë¦¬í˜ì¹˜(ìƒˆë¡œê³ ì¹¨ ì—†ì´ ìµœì‹  ë°ì´í„° ìœ ì§€)** ê¸°ëŠ¥ì´ ìˆìŒ.
- `refreshInterval`ì„ ì¶”ê°€í•˜ë©´ ì¼ì • ì‹œê°„ë§ˆë‹¤ ìë™ ê°±ì‹  ê°€ëŠ¥:

```javascript
jsx
ë³µì‚¬í¸ì§‘
const { data, mutate } = useSWR("/api/articles", fetcher, {
  refreshInterval: 5000, // 5ì´ˆë§ˆë‹¤ ë°ì´í„° ê°±ì‹ 
});
```

- `mutate()`ë¥¼ í˜¸ì¶œí•˜ë©´ **ê°•ì œë¡œ ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´** (ex: ë²„íŠ¼ í´ë¦­ ì‹œ ê°±ì‹ )

```javascript
jsx
ë³µì‚¬í¸ì§‘
<button onClick={() => mutate()}>ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
```


---


## **< React Query ì‚¬ìš©ë²•>**


### **1ï¸âƒ£ ì„¤ì¹˜**


```shell
bash
ë³µì‚¬í¸ì§‘
npm install @tanstack/react-query
# ë˜ëŠ”
yarn add @tanstack/react-query
```


### **2ï¸âƒ£ React Query Provider ì¶”ê°€ (****`_app.js`** **ë˜ëŠ”** **`layout.js`****)**


```javascript
jsx
ë³µì‚¬í¸ì§‘
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";

const queryClient = new QueryClient();

export default function MyApp({ Component, pageProps }) {
  return (
    <QueryClientProvider client={queryClient}>
      <Component {...pageProps} />
    </QueryClientProvider>
  );
}
```


### **3ï¸âƒ£ ê¸°ë³¸ ì‚¬ìš©ë²•**


```javascript
jsx
ë³µì‚¬í¸ì§‘
import { useQuery } from "@tanstack/react-query";

const fetchArticles = async () => {
  const res = await fetch("https://sprint-mission08-be.onrender.com/articles");
  return res.json();
};

export default function Community() {
  const { data, isLoading, error } = useQuery({
    queryKey: ["articles"],
    queryFn: fetchArticles,
  });

  if (isLoading) return <div>â³ ë¡œë”© ì¤‘...</div>;
  if (error) return <div>âŒ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨</div>;

  return (
    <div>
      {data.list.map((article) => (
        <div key={article.id}>{article.title}</div>
      ))}
    </div>
  );
}
```


### **4ï¸âƒ£ Mutation (ë°ì´í„° ìˆ˜ì •/ì‚­ì œ/ì¶”ê°€)**


```javascript
jsx
ë³µì‚¬í¸ì§‘
import { useMutation, useQueryClient } from "@tanstack/react-query";

const postArticle = async (newArticle) => {
  const res = await fetch("/api/articles", {
    method: "POST",
    body: JSON.stringify(newArticle),
  });
  return res.json();
};

export default function CreateArticle() {
  const queryClient = useQueryClient();
  const mutation = useMutation({
    mutationFn: postArticle,
    onSuccess: () => {
      queryClient.invalidateQueries(["articles"]); // ìºì‹œëœ ë°ì´í„°ë¥¼ ë¬´íš¨í™”í•˜ì—¬ ìµœì‹  ë°ì´í„° ê°€ì ¸ì˜´
    },
  });

  return (
    <button onClick={() => mutation.mutate({ title: "ìƒˆ ê¸€" })}>
      âœï¸ ê¸€ ì‘ì„±
    </button>
  );
}
```

