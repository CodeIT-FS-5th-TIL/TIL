# router.pushμ options β€” `shallow: true`

`router.push`μ μ„Έλ²μ§Έ μΈμλ” λ„¤λΉ„κ²μ΄μ… μµμ…μ„ μ„¤μ •ν•λ” κ°μ²΄λ¥Ό λ°›λ”λ‹¤. μµμ… μ¤‘ `shallow: true`λ¥Ό μ‚¬μ©ν•λ©΄ URLλ§ λ³€κ²½λκ³ , `getServerSideProps`κ°€ λ‹¤μ‹ μ‹¤ν–‰λμ§€ μ•λ”λ‹¤.

```jsx
router.push(
  { pathname: "/dashboard", query: { modal: "open" } }, // μ²« λ²μ§Έ μΈμ
  undefined, // λ‘ λ²μ§Έ μΈμ
  { shallow: true } // μ„Έ λ²μ§Έ μΈμ - options
);
```

(μ°Έκ³ λ΅ optionsμ—λ” shallow λ§κ³ λ„ scroll, locale λ“± λ‡ κ°€μ§€ μ¶”κ°€ μµμ…μ΄ μλ‹¤.)

μ–Όν• μƒκ°ν•΄λ΄¤μ„ λ• `shallow: true`κ°€ μ™ ν•„μ”ν•μ§€ λ– μ¤λ¥΄μ§€ μ•μ•„μ„ μμ‹λ¥Ό μ°Ύμ•„ λ³΄μ•λ‹¤.

## **`shallow: true`κ°€ μ μ©ν• κ²½μ°**

- **νμ΄μ§€ μ „μ²΄λ¥Ό λ‹¤μ‹ λ λ”λ§ν•  ν•„μ”κ°€ μ—†μ„ λ•**
- **URLμ„ λ³€κ²½ν•λ, ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“μ—μ„λ§ μƒνƒλ¥Ό μ—…λ°μ΄νΈν•  λ•**
- **λ°μ΄ν„°λ¥Ό λ‹¤μ‹ μ”μ²­ν•μ§€ μ•κ³ , UI μƒνƒλ§ λ°”κΏ€ λ•**

## μμ‹

### 1. **λ¨λ‹¬μ„ μ—΄κ³  λ‹«μ„ λ•**

λ¨λ‹¬ μƒνƒλ¥Ό URLμ— λ°μν•μ§€λ§, **νμ΄μ§€ μ „μ²΄λ¥Ό λ‹¤μ‹ λ λ”λ§ν•μ§€ μ•κ³  μ‹¶μ„ λ•**

```tsx
router.push(
  { pathname: router.pathname, query: { ...router.query, modal: "open" } },
  undefined,
  { shallow: true }
);
```

- μ΄λ ‡κ² ν•λ©΄ **λ¨λ‹¬μ΄ μ—΄λ Έλ‹¤λ” μ •λ³΄κ°€ URLμ— λ°μλμ§€λ§, `getServerSideProps`κ°€ μ‹¤ν–‰λμ§€ μ•μ**.
- μƒλ΅κ³ μΉ¨ν•λ©΄ URLμ„ λ³΄κ³  λ‹¤μ‹ λ¨λ‹¬μ„ μ—΄ μ μμ.

### 2. **νƒ­μ„ λ³€κ²½ν•  λ• (CSR μƒνƒ μ μ§€)**

- `shallow: true`λ¥Ό μ“°λ©΄ URLμ„ λ³€κ²½ν•λ©΄μ„λ„ **μƒλ΅μ΄ λ°μ΄ν„° μ”μ²­ μ—†μ΄ ν΄λΌμ΄μ–ΈνΈμ—μ„ μƒνƒλ¥Ό κ΄€λ¦¬ν•  μ μμ.**

```tsx
router.push(
  { pathname: router.pathname, query: { tab: "comments" } },
  undefined,
  { shallow: true }
);
```

- μ΄λ¬λ©΄ νμ΄μ§€λ¥Ό λ‹¤μ‹ λ λ”λ§ν•μ§€ μ•κ³  νƒ­ UIλ§ λ³€κ²½ κ°€λ¥!

### **3. νμ΄μ§€λ„¤μ΄μ…μ—μ„ ν΄λΌμ΄μ–ΈνΈ μƒνƒλ§ μ—…λ°μ΄νΈν•  λ•**

- ν„μ¬ νμ΄μ§€ λ²νΈλ¥Ό URLμ— λ°μν•μ§€λ§, **λ°μ΄ν„° μ”μ²­ μ—†μ΄ κΈ°μ΅΄ λ°μ΄ν„°λ΅ UIλ§ λ³€κ²½ν•  λ•**
  (λ‹¨, μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό μƒλ΅ λ°›μ•„μ•Ό ν•λ‹¤λ©΄ `shallow: true`λ¥Ό λΉΌμ•Ό ν•¨)

```tsx
router.push({ pathname: router.pathname, query: { page: 2 } }, undefined, {
  shallow: true,
});
```

- μ΄λ¬λ©΄ **νμ΄μ§€ λ²νΈλ§ λ°”λ€κ³ , μ„λ²„ μ”μ²­ μ—†μ΄ κΈ°μ΅΄ λ¦¬μ¤νΈ μ μ§€ κ°€λ¥**.

<aside>
π’΅

**μ •λ¦¬**

- SSR λ°μ΄ν„°λ¥Ό λ‹¤μ‹ λ°›μ•„μ•Ό ν•λ©΄ `shallow: true`λ¥Ό μ‚¬μ©ν•λ©΄ μ• λλ‹¤.
- ν•μ§€λ§ ν΄λΌμ΄μ–ΈνΈμ—μ„λ§ μƒνƒλ¥Ό μ—…λ°μ΄νΈν•κ³  μ‹¶λ‹¤λ©΄ μ μ©ν•λ‹¤.
- λ¨λ‹¬, νƒ­ λ³€κ²½, νμ΄μ§€λ„¤μ΄μ… UI λ³€κ²½ κ°™μ€ κ²½μ°μ— ν™μ© κ°€λ¥!
  </aside>

## λ” μμ„Έν• μμ‹ β€” λ¨λ‹¬

λ¨λ‹¬μ κ²½μ°, λ¨λ‹¬μ„ λ„μ°κ³  λ‹«λ”κ±΄ ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“μ—μ„ μ§„ν–‰λλ‹κΉ κµ³μ΄ μ„λ²„ μ”μ²­μ΄ ν•„μ”ν•μ§€ μ•λ‹¤. ν•μ§€λ§ URLμ—λ” λ¨λ‹¬ μƒνƒλ¥Ό λ°μν•κΈ° μ„ν•΄ `shallow: true`λ¥Ό μ‚¬μ©ν•λ‹¤.

```tsx
import { useRouter } from "next/router";

export default function ExamplePage() {
  const router = useRouter();
  const isModalOpen = router.query.modal === "open";

  const openModal = () => {
    router.push(
      { pathname: router.pathname, query: { ...router.query, modal: "open" } },
      undefined,
      { shallow: true } // μ„λ²„ μ”μ²­ μ—†μ΄ URLλ§ λ³€κ²½
    );
  };

  const closeModal = () => {
    const queryParams = new URLSearchParams(router.query);
    queryParams.delete("modal");

    router.push(
      {
        pathname: router.pathname,
        query: Object.fromEntries(queryParams.entries()),
      },
      undefined,
      { shallow: true } // μ„λ²„ μ”μ²­ μ—†μ΄ URLλ§ λ³€κ²½
    );
  };

  return (
    <div>
      <button onClick={openModal}>λ¨λ‹¬ μ—΄κΈ°</button>

      {isModalOpen && (
        <div className="modal">
          <p>λ¨λ‹¬ λ‚΄μ©</p>
          <button onClick={closeModal}>λ‹«κΈ°</button>
        </div>
      )}
    </div>
  );
}
```

- **λ¨λ‹¬ μ—΄ λ•**
  - `router.push()`λ¥Ό νΈμ¶ν•΄μ„ **URLμ„ `...?modal=open`μΌλ΅ λ³€κ²½**
  - `shallow: true` λ•λ¶„μ— **νμ΄μ§€ μ „μ²΄κ°€ λ‹¤μ‹ λ λ”λ§λμ§€ μ•μ**
  - μƒνƒ(`router.query.modal === "open"`)λ¥Ό κΈ°λ°μΌλ΅ **λ¨λ‹¬μ„ UIμ—μ„ ν‘μ‹**
- **λ¨λ‹¬ λ‹«μ„ λ•**
  - `queryParams.delete("modal")`λ΅ URLμ—μ„ `modal` κ°’μ„ μ κ±°
  - `router.push()` μ‹¤ν–‰ β†’ **URLμ΄ λ³€κ²½λμ§€λ§ μ„λ²„ μ”μ²­ μ—†μ΄ μƒνƒλ§ μ—…λ°μ΄νΈ**
  - **λ¨λ‹¬μ΄ μ‚¬λΌμ§**
